# 文件头文件尾汇总：

| 文件类型                   | 文件头                  | 文件尾      | 特征    |
| -------------------------- | ----------------------- | ----------- | ------- |
| JPEG (jpg)                 | FF D8 FF                | FF D9       | ÿØÿà    |
| PNG (png)                  | 89 50 4E 47             | AE 42 60 82 | .PNG... |
| GIF (gif)                  | 47 49 46 38             | 00 3B       | GIF89a  |
| ZIP Archive (zip)          | 50 4B 03 04             | 50 4B       | PK..    |
| Windows Bitmap (bmp)       | 42 4D                   |             | BM      |
| RAR Archive (rar)          | 52 61 72 21             |             | Rar!... |
| MS Word/Excel (xls.or.doc) | D0 CF 11 E0 A1 B1 1A E1 |             |         |
| Adobe Acrobat (pdf)        | 25 50 44 46 2D 31 2E    |             | %PDF    |
|                            |                         |             |         |

复合文档结构分析

> 0~2B  复合文档一样 
>
> 2C~2F 表示分区表扇区总数 （SAT）表示有几个 FD FF FF FF 
>
> 30 ~33 表示目录流第一个扇区的 ID 第一个 FD FF FF FF 所在扇区 
>
> 34~37 不用 
>
> 38~3B 通常值 4096 
>
> 3C~3F 表示短分区表(SSAT) ROOT 偏移 74 位置减一 
>
> 40~43 短分区表扇区总数 一般为 1 
>
> 44~47  表示主分区表（MSAT） 一般 FFFF 
>
> 48~4B  表示分区表扇区总数 一般为 0 记录最大为109个 当大于109 或者文档大于6.8M 
>
> 44~47 48~ 4B 才会变动 下面 会讲到 
>
> 4C~4F 第一个 FD FF FF FF 在第一扇区 则为 0 
>
> 4C ~1F0 F 记录 搜索 FDFFFFFF 前一个减 2 或者后一个减 1 

![用WinHex修复损坏的复合文档文件头_职场_04](https://s9.51cto.com/attachment/201001/201001251264414380921.jpg)

